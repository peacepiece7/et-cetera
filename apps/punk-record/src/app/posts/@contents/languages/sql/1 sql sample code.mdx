-- Test table
CREATE TABLE IF NOT EXISTS firstschema.test (
id SERIAL PRIMARY KEY,
name VARCHAR NOT NULL,
code VARCHAR NOT NULL,
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- join practice
create schema if not exists practice;
create table if not exists practice.join_sample_1 (
col1 int,
col2 varchar,
col3 varchar
);
create table if not exists practice.join_sample_2 (
col1 int,
col4 varchar
);

insert into practice.join_sample_1 values
(1, 'A', 'D'),
(3, 'B', 'E'),
(5, 'C', 'F');

insert into practice.join_sample_2 values
(2, 'G'),
(3, 'H'),
(3, 'I');

-- Band table
CREATE TABLE IF NOT EXISTS firstschema.band (
band_code VARCHAR PRIMARY KEY,
band_name VARCHAR NOT NULL
);

-- Band role table with unique role_name
CREATE TABLE IF NOT EXISTS firstschema.band_role (
code VARCHAR PRIMARY KEY,
role_name VARCHAR NOT NULL UNIQUE, -- role_name must be unique
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Band member table with unique name within the same band_code
CREATE TABLE IF NOT EXISTS firstschema.band_member (
id SERIAL PRIMARY KEY,
"name" VARCHAR NOT NULL,
age INT NOT NULL CHECK (age >= 0),
band_code VARCHAR,
member_role_code VARCHAR, -- References the VARCHAR code from band_role
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
CONSTRAINT band_member_band_code_fk FOREIGN KEY (band_code)
REFERENCES firstschema.band (band_code)
ON DELETE CASCADE,
CONSTRAINT band_member_member_role_code_fk FOREIGN KEY (member_role_code)
REFERENCES firstschema.band_role (code) -- References VARCHAR code
ON DELETE CASCADE,
CONSTRAINT band_member_name_unique UNIQUE ("name", band_code) -- name must be unique within the same band_code
);

-- Store table
CREATE TABLE IF NOT EXISTS firstschema.store (
ticket_id SERIAL PRIMARY KEY,
performance_name VARCHAR NOT NULL,
performance_date TIMESTAMP NOT NULL,
band_code VARCHAR,
CONSTRAINT store_band_code_fk FOREIGN KEY (band_code)
REFERENCES firstschema.band (band_code)
ON DELETE CASCADE
);

-- Audience table
CREATE TABLE IF NOT EXISTS firstschema.audience (
id SERIAL PRIMARY KEY,
nickname VARCHAR,
ticket_id INTEGER,
CONSTRAINT audience_ticket_id_fk FOREIGN KEY (ticket_id)
REFERENCES firstschema.store (ticket_id)
ON DELETE CASCADE
);

-- Audience review table with ticket_id
CREATE TABLE IF NOT EXISTS firstschema.audience_review (
id SERIAL PRIMARY KEY,
audience_id INTEGER,
ticket_id INTEGER, -- 어떤 공연에 대한 리뷰인지 나타내는 컬럼
review TEXT NOT NULL,
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
CONSTRAINT audience_review_audience_id_fk FOREIGN KEY (audience_id)
REFERENCES firstschema.audience (id)
ON DELETE CASCADE,
CONSTRAINT audience_review_ticket_id_fk FOREIGN KEY (ticket_id)
REFERENCES firstschema.store (ticket_id)
ON DELETE CASCADE
);

-- Band role data
INSERT INTO firstschema.band_role (code, role_name)
VALUES
('VOC', 'Vocalist'),
('GTR', 'Guitarist'),
('DRM', 'Drummer'),
('BSS', 'Bassist'),
('KBD', 'Keyboardist'),
('PER', 'Percussionist'),
('BKV', 'Backup Vocalist');

-- Band data
INSERT INTO firstschema.band (band_code, band_name)
VALUES
('B001', 'The Rolling Stones'),
('B002', 'The Beatles'),
('B003', 'Led Zeppelin'),
('B004', 'Pink Floyd'),
('B005', 'Queen'),
('B006', 'The Who'),
('B007', 'Nirvana'),
('B008', 'Metallica'),
('B009', 'AC/DC'),
('B010', 'Red Hot Chili Peppers');

-- Band member data (50 members across 10 bands)
INSERT INTO firstschema.band_member ("name", age, band_code, member_role_code)
VALUES
-- The Rolling Stones
('Mick Jagger', 77, 'B001', 'VOC'),
('Keith Richards', 77, 'B001', 'GTR'),
('Charlie Watts', 80, 'B001', 'DRM'),
('Ronnie Wood', 74, 'B001', 'GTR'),
('Darryl Jones', 65, 'B001', 'BSS'),
-- The Beatles
('Paul McCartney', 78, 'B002', 'VOC'),
('John Lennon', 80, 'B002', 'GTR'),
('George Harrison', 79, 'B002', 'GTR'),
('Ringo Starr', 81, 'B002', 'DRM'),
-- Led Zeppelin
('Robert Plant', 72, 'B003', 'VOC'),
('Jimmy Page', 77, 'B003', 'GTR'),
('John Paul Jones', 75, 'B003', 'BSS'),
('John Bonham', 70, 'B003', 'DRM'),
-- Pink Floyd
('David Gilmour', 75, 'B004', 'GTR'),
('Roger Waters', 78, 'B004', 'BSS'),
('Nick Mason', 76, 'B004', 'DRM'),
('Richard Wright', 75, 'B004', 'KBD'),
-- Queen
('Freddie Mercury', 45, 'B005', 'VOC'),
('Brian May', 74, 'B005', 'GTR'),
('Roger Taylor', 72, 'B005', 'DRM'),
('John Deacon', 70, 'B005', 'BSS'),
-- The Who
('Roger Daltrey', 77, 'B006', 'VOC'),
('Pete Townshend', 76, 'B006', 'GTR'),
('John Entwistle', 74, 'B006', 'BSS'),
('Keith Moon', 78, 'B006', 'DRM'),
-- Nirvana
('Kurt Cobain', 27, 'B007', 'VOC'),
('Krist Novoselic', 56, 'B007', 'BSS'),
('Dave Grohl', 52, 'B007', 'DRM'),
-- Metallica
('James Hetfield', 58, 'B008', 'VOC'),
('Kirk Hammett', 59, 'B008', 'GTR'),
('Lars Ulrich', 57, 'B008', 'DRM'),
('Robert Trujillo', 56, 'B008', 'BSS'),
-- AC/DC
('Brian Johnson', 73, 'B009', 'VOC'),
('Angus Young', 66, 'B009', 'GTR'),
('Phil Rudd', 67, 'B009', 'DRM'),
('Cliff Williams', 71, 'B009', 'BSS'),
-- Red Hot Chili Peppers
('Anthony Kiedis', 59, 'B010', 'VOC'),
('Flea', 58, 'B010', 'BSS'),
('Chad Smith', 59, 'B010', 'DRM'),
('John Frusciante', 51, 'B010', 'GTR'),
('Josh Klinghoffer', 42, 'B010', 'GTR'),
('Jack Irons', 58, 'B010', 'DRM'),
('Arik Marshall', 55, 'B010', 'GTR'),
('Clara Balzary', 30, 'B010', 'BKV'); -- Backup Vocalist

-- Store (performance) data
delete from firstschema.store;
SELECT pg_get_serial_sequence('firstschema.store', 'ticket_id');
alter sequence firstschema.store_ticket_id_seq restart with 1;
INSERT INTO firstschema.store (performance_name, performance_date, band_code)
VALUES
('Rolling Stones Live in Hyde Park', '2024-08-20 19:00:00', 'B001'),
('The Beatles Reunion Concert', '2024-09-15 20:00:00', 'B002'),
('Led Zeppelin World Tour', '2024-10-05 21:00:00', 'B003'),
('Pink Floyd The Wall Show', '2024-11-10 19:30:00', 'B004'),
('Queen Greatest Hits Tour', '2024-12-01 20:00:00', 'B005'),
('The Who Hits 50!', '2024-12-15 19:00:00', 'B006'),
('Nirvana Unplugged', '2025-01-20 18:00:00', 'B007'),
('Red Hot Chili Peppers World Tour', '2024-04-29 21:00:00', 'B010'),
('Metallica Worldwired Tour', '2025-02-10 20:00:00', 'B008'),
('AC/DC Rock or Bust', '2025-03-15 20:00:00', 'B009'),
('Red Hot Chili Peppers Stadium Arcadium Tour', '2025-04-20 21:00:00', 'B010');

-- Audience data (100 audiences)
INSERT INTO firstschema.audience (nickname, ticket_id)
VALUES
('rock_fan_01', 1),('rock_fan_01', 10), ('beatles_fan_42', 2), ('zeppelin_lover', 3), ('pink_floyd_dreamer', 4),
('queen_enthusiast', 5), ('who_are_you', 6), ('nirvana_diehard', 7), ('metallica_headbanger', 8),
('acdc_thunder', 9), ('chili_pepper', 10), ('stones_fanatic', 1), ('beatles_mania', 2),
('zep_guitar_hero', 3), ('floydian_slip', 4), ('mercury_rising', 5), ('daltrey_roar', 6),
('cobain_fan', 7), ('metal_militia', 8), ('high_voltage', 9), ('stadium_rocker', 10),
('stone_rock', 1), ('lennon_legend', 2), ('page_pride', 3), ('comfortably_numb', 4),
('bohemian_rhapsody', 5), ('baba_oriley', 6), ('teen_spirit', 7), ('metal_up_your_ass', 8),
('back_in_black', 9), ('scar_tissue', 10), ('mick_lover', 1), ('fab_four_lover', 2),
('zeppelin_rocker', 3), ('shine_on', 4),('shine_on', 6), ('killer_queen', 5), ('quadrophenia', 6),
('nirvana_fan', 7), ('enter_sandman', 8), ('you_shook_me', 9), ('californication', 10),
('rolling_stone', 1), ('let_it_be', 2), ('ramble_on', 3), ('dark_side_of_moon', 4),
('radio_gaga', 5), ('the_real_me', 6), ('heart_shaped_box', 7), ('ride_the_lightning', 8),
('rock_n_roll_train', 9), ('soul_to_squeeze', 10), ('midnight_rambler', 1), ('yesterday', 2),
('whole_lotta_love', 3), ('wish_you_were_here', 4), ('we_will_rock_you', 5),
('pinball_wizard', 6), ('nirvana_soul', 7), ('for_whom_the_bell_tolls', 8), ('hells_bells', 9),
('snow_hey_oh', 10), ('tumblin_dice', 1), ('hey_jude', 2), ('stairway_to_heaven', 3),
('breathe', 4), ('somebody_to_love', 5), ('love_reign_oer_me', 6), ('nirvana_blew', 7),
('creeping_death', 8), ('tnt', 9), ('give_it_away', 10), ('paint_it_black', 1),
('come_together', 2), ('black_dog', 3), ('money', 4), ('dont_stop_me_now', 5),
('my_generation', 6), ('lake_of_fire', 7), ('one', 8), ('dirty_deeds', 9),
('by_the_way', 10), ('jumpin_jack_flash', 1), ('all_you_need_is_love', 2), ('kashmir', 3),
('us_and_them', 4), ('under_pressure', 5), ('bargain', 6), ('smells_like_teen_spirit', 7),
('master_of_puppets', 8), ('highway_to_hell', 9), ('suck_my_kiss', 10);

-- Audience review data (30 reviews)
INSERT INTO firstschema.audience_review (audience_id, ticket_id, review)
VALUES
(1, 1, 'Amazing performance by the Rolling Stones! It was a night to remember.'),
(2, 2, 'The Beatles were just as legendary as I imagined. A once-in-a-lifetime experience.'),
(3, 3, 'Led Zeppelin rocked the stage! The energy was electric.'),
(4, 4, 'Pink Floyd''s visuals were out of this world! The Wall Show was mesmerizing.'),
(5, 5, 'Queen delivered a powerful performance. Freddie may be gone, but the legacy lives on.'),
(6, 6, 'The Who still have it! Their energy is unmatched.'),
(7, 7, 'Nirvana Unplugged was an emotional experience. Kurt''s voice touched everyone''s heart.'),
(8, 8, 'Metallica brought the house down with their powerful riffs and thundering drums.'),
(9, 9, 'AC/DC knows how to keep the crowd alive! Rock or Bust indeed.'),
(10, 10, 'Red Hot Chili Peppers were on fire! Every song was a hit.'),
(11, 1, 'The Rolling Stones still got the moves!'),
(12, 2, 'The Beatles performed all my favorite classics.'),
(13, 3, 'Led Zeppelin''s Stairway to Heaven live was a spiritual experience.'),
(14, 4, 'Pink Floyd''s Comfortably Numb was out of this world.'),
(15, 5, 'Queen''s Bohemian Rhapsody live is a memory I''ll cherish forever.'),
(16, 6, 'The Who''s Baba O''Riley was the highlight of the night.'),
(17, 7, 'Nirvana''s Unplugged version of About a Girl was hauntingly beautiful.'),
(18, 8, 'Metallica''s Enter Sandman live is pure adrenaline.'),
(19, 9, 'AC/DC''s Thunderstruck live - the crowd went wild!'),
(20, 10, 'Red Hot Chili Peppers'' Californication was a perfect closing song.'),
(21, 1, 'The Rolling Stones know how to throw a party!'),
(22, 2, 'The Beatles reunited and it was magical.'),
(23, 3, 'Led Zeppelin''s Whole Lotta Love live was unforgettable.'),
(24, 4, 'Pink Floyd''s Dark Side of the Moon performance was an experience like no other.'),
(25, 5, 'Queen''s Radio Ga Ga had everyone singing along.'),
(26, 6, 'The Who''s Pinball Wizard was electrifying.'),
(27, 7, 'Nirvana''s unplugged version of The Man Who Sold the World gave me chills.'),
(28, 8, 'Metallica''s For Whom the Bell Tolls live - absolutely mind-blowing.'),
(29, 9, 'AC/DC''s Highway to Hell live is everything you would expect and more.'),
(30, 10, 'Red Hot Chili Peppers'' performance of Scar Tissue was deeply moving.');
