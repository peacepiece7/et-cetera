# commitlint

ì´ë ‡ê²Œ ì„¤ì¹˜

```
pnpm install --save-dev -w @commitlint/cli @commitlint/config-conventional
```

`@commitlint/config-conventional` : [angular commit message convention](https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/config-conventional#type-enum)ì„ ì‚¬ìš©í•œë‹¤.
(`feat: foo` `fix: bar` ì´ëŸ° ëŠë‚Œ)

ê·¸ë¦¬ê³  ì´ë ‡ê²Œ ì„¤ì •í–ˆë‹¤.

```js
// commitlint.config.mjs

const Configuration = {
  extends: ["@commitlint/config-conventional"],
  rules: {
    "header-max-length": [2, "always", 72],
    "body-leading-blank": [2, "always"],
    "body-max-line-length": [2, "always", 80],
  },
}

export default Configuration
```

commit-msg hookì— huskyë¥¼ ì‚¬ìš©í•´ì„œ ì„¤ì •í•˜ì.

```sh
# .husky/commit-msg

npx --no -- commitlint --config commitlint.config.mjs --edit "${1}"
```

`git add . && git commit`ë¥¼ ì‹¤í–‰í•˜ë©´ commitlintê°€ ë™ì‘í•œë‹¤.

### ì»¤ìŠ¤í…€ í”ŒëŸ¬ê·¸ì¸ ë§Œë“¤ê¸°

`@commitlint/config-conventional`ëŠ” í•œê¸€ ì§€ì›ì´ ì•ˆëœë‹¤. í•œê¸€ì„ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´, í”ŒëŸ¬ê·¸ì¸ì„ ì§ì ‘ ë§Œë“¤ì. (`@commitlint/config-conventional` ëº´ë„ ëœë‹¤.)

```js
const Configuration = {
  extends: ["@commitlint/config-conventional"],
  rules: {
    "subject-case": [2, "never", ["upper-case", "pascal-case", "start-case"]], // subject-case : any
    "header-max-length": [2, "always", 72],
    "body-leading-blank": [2, "always"],
    "body-max-line-length": [2, "always", 225],
    "footer-leading-blank": [2, "always"],
    "type-enum-kor": [2, "always", ["ê¸°ëŠ¥", "ë²„ê·¸", "ê°œì„ "]],
    "type-empty-kor": [2, "always"],
    "type-enum": [0, "always"], // ì˜ì–´ë§Œ ì…ë ¥ ë°›ëŠ”ê±° ë¬´ì‹œ
    "type-empty": [0, "always"], // í•œê¸€ ì…ë ¥ì‹œ empty ì—ëŸ¬ ë¬´ì‹œ
    "subject-empty": [0, "always"], // í•œê¸€ ì…ë ¥ì‹œ empty ì—ëŸ¬ ë¬´ì‹œ
  },
  plugins: [{ rules: { "type-enum-kor": typeEnumWithKor, "type-empty-kor": typeEmptyWithKor } }],
}

function typeEnumWithKor(value) {
  const { header, always, ...rest } = value
  const type = header.split(":")[0].split("(")[0]
  const keys = ["ê¸°ëŠ¥", "ë²„ê·¸", "ê°œì„ "]
  return [keys.some((t) => t === type), "ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”: " + keys.join(", ")]
}

function typeEmptyWithKor(value) {
  const { header, always, ...rest } = value
  const regex = /^[ê°€-í£a-zA-Z]+\([ê°€-í£a-zA-Z0-9]*\)!?:\s[^\s]+.*|^[ê°€-í£a-zA-Z]+!?:\s[^\s]+.*$/

  const isMatched = regex.test(header)
  return [isMatched, 'ë¨¸ë¦¿ë§ì„ ì–‘ì‹ì— ë§ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš” (ì˜ˆ: "feat(comments): message", "fix(bug): message" )']
}

export default Configuration
```

### ëŒ€í™”í˜•ìœ¼ë¡œ êµ¬ì„±í•˜ê¸°

ëŒ€í™”í˜• êµ¬ì„±ì€ unix ê³„ì—´ì—ì„œë§Œ í•˜ëŠ”ê²Œ ì¢‹ë‹¤.

window í™˜ê²½ì—ì„œ ëŒ€í™”í•˜ëŠ” ê²ƒì€ ê±´ê°•ì— ì¢‹ì§€ ì•Šë‹¤.

[commitlint prompt](https://commitlint.js.org/reference/prompt.html#prompt)ì—¬ê¸°ë¥¼ ì°¸ê³ 

`cz-customizable`ì„ ì‚¬ìš©í•´ì„œ êµ¬ì„±í•  ê³„íšì´ë©´ ë‹¤ìŒ ë§í¬ë¥¼ ì°¸ê³ 

[commitlint/issues/2684](https://github.com/conventional-changelog/commitlint/issues/2684)  
[blog cz-customizable](https://velog.io/@restarea/cz-customizable)

[pre-commitì„ Inquirerë¡œ hooking](https://github.com/SBoudrias/Inquirer.js?tab=readme-ov-file#using-as-pre-commitgit-hooks-or-scripts)í•˜ëŠ” ë°©ë²•ë„ ê³ ë ¤í•´ë³´ì.

ëŒ€í™”í˜•ìœ¼ë¡œ ì»¤ë°‹ì„ êµ¬ì„± í•˜ë ¤ë©´ ë‹¤ìŒ ì‹œí€€ìŠ¤ë¡œ ë§Œë“¤ê³ ì í•˜ëŠ”ë° ìœˆë„ìš° ì–´ì©Œì§€...

```
`git commit` ì…ë ¥
    -> husky prepare-commit-msg ì‹¤í–‰
        -> commitlint(commitlint.config.js) ì‹¤í–‰
        -> commitlint ì„¤ì •ì„ ë°›ì•„ì„œ ëŒ€í™”í˜• êµ¬ì„± ì‹¤í–‰ (inquirer)
        -> .git/COMMIT_EDITMSGì— ê²°ê³¼ ì €ì¥
    -> husky commit-msg ì‹¤í–‰
        -> commitlint rules ê²€ì‚¬ ì‹¤í–‰
```

## git commit template ì„¤ì •

`git config commit.template <file>`ë¡œ ì„¤ì •í•˜ë©´ ëœë‹¤.

```js
// script.js
const GIT_COMMIT_TEMPLATE = `

# NOTE: 
# ë‹¤ìŒ í˜•íƒœë¡œ ì»¤ë°‹ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.
# <íƒ€ì…>[ì ìš© ë²”ìœ„(ì„ íƒ ì‚¬í•­)]: <ì„¤ëª…>
#
#[ë³¸ë¬¸(ì„ íƒ ì‚¬í•­)]
#
#[ê¼¬ë¦¬ë§(ì„ íƒ ì‚¬í•­)]
#

# EXAMPLE:
# fix(libraryName) : ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” êµ¬ì‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì œê±°
#
# ì €ë… ë§¤ë‰´ ì¶”ì²œ ë°›ìŠµë‹ˆë‹¤.
# ì£¼ë§ì—” ë†€ê³  ì‹¶ì–´ìš”.
# 
# - nodejs ë²„ì „ì´ ì˜¬ë¼ê°€ë©´ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì œê±°
# - newLibararyNameìœ¼ë¡œ í†µí•©
# - libraryNameë¥¼ ì‚¬ìš©ì¤‘ì¸ ê²½ìš° newLibararyNameìœ¼ë¡œ ë³€ê²½ í•„ìš”
#
# Resolves: #123, #245
# Closes issue by #123
# Pull request: #123
# Refs: 676104e, a215868

# REFERENCE:
# https://github.com/angular/angular/blob/68a6a07/CONTRIBUTING.md#commit
# https://www.conventionalcommits.org/ko/v1.0.0/

# HEADER_TYPE:
${Object.keys(GIT_COMMIT_CONFIGURATION["type-enum-kor"])
  .map((key) => {
    return `# ${key} : ${GIT_COMMIT_CONFIGURATION["type-enum-kor"][key].description}`
  })
  .join("\n")}
  
# REMEMBER_ME:
# HEADER TYPEì€ ì˜ì–´ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.
# í•œê¸€ì„ ì§€í–¥í•©ë‹ˆë‹¤.
# ì œëª© ëì— ë§ˆì¹¨í‘œ ê¸ˆì§€
# ë³¸ë¬¸ëŠ” "ë¬´ì—‡ì„", "ì™œ"ì— ëŒ€í•œ ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.
`

fs.writeFileSync("./git_commit_template.txt", GIT_COMMIT_TEMPLATE)
```

packge.jsonì— prepareë¥¼ ì‹¤í–‰í•  ë–„ git commit templateì´ ëŒì•„ê°€ë„ë¡ ì„¤ì •í•˜ì

```json
{
  "scripts": {
    "prepare": "husky & node ./script.js & git config commit.template ./git_commit_template.txt"
  }
}
```

## ì°¸ê³ 

[ğŸ¨ commitlint ê³µì‹ë¬¸ì„œ ë§í¬](https://commitlint.js.org/)
[commitlint/issues/2684](https://github.com/conventional-changelog/commitlint/issues/2684)  
[blog cz-customizable](https://velog.io/@restarea/cz-customizable)
[pre-commitì„ Inquirerë¡œ hooking](https://github.com/SBoudrias/Inquirer.js?tab=readme-ov-file#using-as-pre-commitgit-hooks-or-scripts)
[commitlint prompt](https://commitlint.js.org/reference/prompt.html#prompt)
